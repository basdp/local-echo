var LocalEchoController=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e){var r,n,i,s,a,o,u,l,h,c,p,d,f,v,m,y,_,g,I;f=/\/(?![*\/])(?:\[(?:(?![\]\\]).|\\.)*\]|(?![\/\]\\]).|\\.)*(\/[$_\u200C\u200D\p{ID_Continue}]*|\\)?/uy,d=/--|\+\+|&&|\|\||=>|\.{3}|\??\.(?!\d)|\?{2}|(?:[+\-%&|^]|\*{1,2}|<{1,2}|>{1,3}|!=?|={1,2}|\/(?![\/*]))=?|[?~,:;[\](){}]/y,r=/(?=[$_\p{ID_Start}\\])(?:[$_\u200C\u200D\p{ID_Continue}]|\\u[\da-fA-F]{4}|\\u\{[\da-fA-F]+\})+/uy,m=/(['"])(?:(?!\1)[^\\\n\r]|\\(?:\r\n|[^]))*(\1)?/y,p=/(?:0[xX][\da-fA-F]+|0[oO][0-7]+|0[bB][01]+)n?|0n|[1-9]\d*n|(?:(?:0(?!\d)|0\d*[89]\d*|[1-9]\d*)(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?|0[0-7]+/y,y=/[`}](?:[^`\\$]|\\[^]|\$(?!\{))*(`|\$\{)?/y,I=/[\t\v\f\ufeff\p{Zs}]+/uy,l=/\r?\n|[\r\u2028\u2029]/y,h=/\/\*(?:[^*]|\*(?!\/))*(\*\/)?/y,v=/\/\/.*/y,i=/[<>.:={}]|\/(?![\/*])/y,n=/[$_\p{ID_Start}][$_\u200C\u200D\p{ID_Continue}-]*/uy,s=/(['"])(?:(?!\1)[^])*(\1)?/y,a=/[^<>{}]+/y,g=/^(?:[\/+-]|\.{3}|\?(?:InterpolationIn(?:JSX|Template)|NoLineTerminatorHere|NonExpressionParenEnd|UnaryIncDec))?$|[{}([,;<>=*%&|^!~?:]$/,_=/^(?:=>|[;\]){}]|else|\?(?:NoLineTerminatorHere|NonExpressionParenEnd))?$/,o=/^(?:await|case|default|delete|do|else|instanceof|new|return|throw|typeof|void|yield)$/,u=/^(?:return|throw|yield)$/,c=RegExp(l.source),t.exports=function*(t,{jsx:e=!1}={}){var b,x,P,S,w,C,k,T,J,E,A,X,D,z;for(({length:C}=t),S=0,w="",z=[{tag:"JS"}],b=[],A=0,X=!1;S<C;){switch((T=z[z.length-1]).tag){case"JS":case"JSNonExpressionParen":case"InterpolationInTemplate":case"InterpolationInJSX":if("/"===t[S]&&(g.test(w)||o.test(w))&&(f.lastIndex=S,k=f.exec(t))){S=f.lastIndex,w=k[0],X=!0,yield{type:"RegularExpressionLiteral",value:k[0],closed:void 0!==k[1]&&"\\"!==k[1]};continue}if(d.lastIndex=S,k=d.exec(t)){switch(D=k[0],J=d.lastIndex,E=D,D){case"(":"?NonExpressionParenKeyword"===w&&z.push({tag:"JSNonExpressionParen",nesting:A}),A++,X=!1;break;case")":A--,X=!0,"JSNonExpressionParen"===T.tag&&A===T.nesting&&(z.pop(),E="?NonExpressionParenEnd",X=!1);break;case"{":d.lastIndex=0,P=!_.test(w)&&(g.test(w)||o.test(w)),b.push(P),X=!1;break;case"}":switch(T.tag){case"InterpolationInTemplate":if(b.length===T.nesting){y.lastIndex=S,k=y.exec(t),S=y.lastIndex,w=k[0],"${"===k[1]?(w="?InterpolationInTemplate",X=!1,yield{type:"TemplateMiddle",value:k[0]}):(z.pop(),X=!0,yield{type:"TemplateTail",value:k[0],closed:"`"===k[1]});continue}break;case"InterpolationInJSX":if(b.length===T.nesting){z.pop(),S+=1,w="}",yield{type:"JSXPunctuator",value:"}"};continue}}E=(X=b.pop())?"?ExpressionBraceEnd":"}";break;case"]":X=!0;break;case"++":case"--":E=X?"?PostfixIncDec":"?UnaryIncDec";break;case"<":if(e&&(g.test(w)||o.test(w))){z.push({tag:"JSXTag"}),S+=1,w="<",yield{type:"JSXPunctuator",value:D};continue}X=!1;break;default:X=!1}S=J,w=E,yield{type:"Punctuator",value:D};continue}if(r.lastIndex=S,k=r.exec(t)){switch(S=r.lastIndex,E=k[0],k[0]){case"for":case"if":case"while":case"with":"."!==w&&"?."!==w&&(E="?NonExpressionParenKeyword")}w=E,X=!o.test(k[0]),yield{type:"IdentifierName",value:k[0]};continue}if(m.lastIndex=S,k=m.exec(t)){S=m.lastIndex,w=k[0],X=!0,yield{type:"StringLiteral",value:k[0],closed:void 0!==k[2]};continue}if(p.lastIndex=S,k=p.exec(t)){S=p.lastIndex,w=k[0],X=!0,yield{type:"NumericLiteral",value:k[0]};continue}if(y.lastIndex=S,k=y.exec(t)){S=y.lastIndex,w=k[0],"${"===k[1]?(w="?InterpolationInTemplate",z.push({tag:"InterpolationInTemplate",nesting:b.length}),X=!1,yield{type:"TemplateHead",value:k[0]}):(X=!0,yield{type:"NoSubstitutionTemplate",value:k[0],closed:"`"===k[1]});continue}break;case"JSXTag":case"JSXTagEnd":if(i.lastIndex=S,k=i.exec(t)){switch(S=i.lastIndex,E=k[0],k[0]){case"<":z.push({tag:"JSXTag"});break;case">":z.pop(),"/"===w||"JSXTagEnd"===T.tag?(E="?JSX",X=!0):z.push({tag:"JSXChildren"});break;case"{":z.push({tag:"InterpolationInJSX",nesting:b.length}),E="?InterpolationInJSX",X=!1;break;case"/":"<"===w&&(z.pop(),"JSXChildren"===z[z.length-1].tag&&z.pop(),z.push({tag:"JSXTagEnd"}))}w=E,yield{type:"JSXPunctuator",value:k[0]};continue}if(n.lastIndex=S,k=n.exec(t)){S=n.lastIndex,w=k[0],yield{type:"JSXIdentifier",value:k[0]};continue}if(s.lastIndex=S,k=s.exec(t)){S=s.lastIndex,w=k[0],yield{type:"JSXString",value:k[0],closed:void 0!==k[2]};continue}break;case"JSXChildren":if(a.lastIndex=S,k=a.exec(t)){S=a.lastIndex,w=k[0],yield{type:"JSXText",value:k[0]};continue}switch(t[S]){case"<":z.push({tag:"JSXTag"}),S++,w="<",yield{type:"JSXPunctuator",value:"<"};continue;case"{":z.push({tag:"InterpolationInJSX",nesting:b.length}),S++,w="?InterpolationInJSX",X=!1,yield{type:"JSXPunctuator",value:"{"};continue}}I.lastIndex=S,(k=I.exec(t))?(S=I.lastIndex,yield{type:"WhiteSpace",value:k[0]}):(l.lastIndex=S,(k=l.exec(t))?(S=l.lastIndex,X=!1,u.test(w)&&(w="?NoLineTerminatorHere"),yield{type:"LineTerminatorSequence",value:k[0]}):(h.lastIndex=S,(k=h.exec(t))?(S=h.lastIndex,c.test(k[0])&&(X=!1,u.test(w)&&(w="?NoLineTerminatorHere")),yield{type:"MultiLineComment",value:k[0],closed:void 0!==k[1]}):(v.lastIndex=S,(k=v.exec(t))?(S=v.lastIndex,X=!1,yield{type:"SingleLineComment",value:k[0]}):(S+=(x=String.fromCodePoint(t.codePointAt(S))).length,w=x,X=!1,yield{type:T.tag.startsWith("JSX")?"JSXInvalid":"Invalid",value:x}))))}}},function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.r(e),r.d(e,"HistoryController",(function(){return i}));var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.size=e,this.entries=[],this.cursor=0}var e,r,i;return e=t,(r=[{key:"push",value:function(t){""!==t.trim()&&t!=this.entries[this.entries.length-1]&&(this.entries.push(t),this.entries.length>this.size&&this.entries.pop(0),this.cursor=this.entries.length)}},{key:"rewind",value:function(){this.cursor=this.entries.length}},{key:"getPrevious",value:function(){var t=Math.max(0,this.cursor-1);return this.cursor=t,this.entries[t]}},{key:"getNext",value:function(){var t=Math.min(this.entries.length,this.cursor+1);return this.cursor=t,this.entries[t]}}])&&n(e.prototype,r),i&&n(e,i),t}(),s=r(0),a=r.n(s);function o(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t){return Array.from(a()(t),(function(t){return t.value}))}function h(t){for(var e,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],i=/\w+/g;e=i.exec(t);)r?n.push(e.index):n.push(e.index+e[0].length);return n}function c(t,e){var r=h(t,!0).reverse().find((function(t){return t<e}));return null==r?0:r}function p(t,e,r){for(var n=0,i=0,s=0;s<e;++s){("\n"==t.charAt(s)||(i+=1)>r)&&(i=0,n+=1)}return{row:n,col:i}}function d(t,e){return p(t,t.length,e).row+1}function f(t){return null!=t.match(/[^\\][ \t]$/m)}function v(t){return""===t.trim()||f(t)?"":l(t).pop()||""}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var _=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};m(this,t),this.term=e,this._handleTermData=this.handleTermData.bind(this),this._handleTermResize=this.handleTermResize.bind(this),this.history=new i(r.historySize||10),this.maxAutocompleteEntries=r.maxAutocompleteEntries||100,this._autocompleteHandlers=[],this._active=!1,this._input="",this._cursor=0,this._activePrompt=null,this._activeCharPrompt=null,this._termSize={cols:0,rows:0},this._disposables=[],e&&(e.loadAddon?e.loadAddon(this):this.attach())}var e,r,n;return e=t,(r=[{key:"activate",value:function(t){this.term=t,this.attach()}},{key:"dispose",value:function(){this.detach()}},{key:"detach",value:function(){this.term.off?(this.term.off("data",this._handleTermData),this.term.off("resize",this._handleTermResize)):(this._disposables.forEach((function(t){return t.dispose()})),this._disposables=[])}},{key:"attach",value:function(){this.term.on?(this.term.on("data",this._handleTermData),this.term.on("resize",this._handleTermResize)):(this._disposables.push(this.term.onData(this._handleTermData)),this._disposables.push(this.term.onResize(this._handleTermResize))),this._termSize={cols:this.term.cols,rows:this.term.rows}}},{key:"addAutocompleteHandler",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this._autocompleteHandlers.push({fn:t,args:r})}},{key:"removeAutocompleteHandler",value:function(t){var e=this._autocompleteHandlers.findIndex((function(e){return e.fn===t}));-1!==e&&this._autocompleteHandlers.splice(e,1)}},{key:"read",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"> ";return new Promise((function(n,i){e.term.write(t),e._activePrompt={prompt:t,continuationPrompt:r,resolve:n,reject:i},e._input="",e._cursor=0,e._active=!0}))}},{key:"readChar",value:function(t){var e=this;return new Promise((function(r,n){e.term.write(t),e._activeCharPrompt={prompt:t,resolve:r,reject:n}}))}},{key:"abortRead",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"aborted";null==this._activePrompt&&null==this._activeCharPrompt||this.term.write("\r\n"),null!=this._activePrompt&&(this._activePrompt.reject(t),this._activePrompt=null),null!=this._activeCharPrompt&&(this._activeCharPrompt.reject(t),this._activeCharPrompt=null),this._active=!1}},{key:"println",value:function(t){this.print(t+"\n")}},{key:"print",value:function(t){var e=t.replace(/[\r\n]+/g,"\n");this.term.write(e.replace(/\n/g,"\r\n"))}},{key:"printWide",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0==t.length)return println("");for(var r=t.reduce((function(t,e){return Math.max(t,e.length)}),0)+e,n=Math.floor(this._termSize.cols/r),i=Math.ceil(t.length/n),s=0,a=0;a<i;++a){for(var o="",u=0;u<n;++u)if(s<t.length){var l=t[s++];o+=l+=" ".repeat(r-l.length)}this.println(o)}}},{key:"applyPrompts",value:function(t){var e=(this._activePrompt||{}).prompt||"",r=(this._activePrompt||{}).continuationPrompt||"";return e+t.replace(/\n/g,"\n"+r)}},{key:"applyPromptOffset",value:function(t,e){return this.applyPrompts(t.substr(0,e)).length}},{key:"clearInput",value:function(){for(var t=this.applyPrompts(this._input),e=d(t,this._termSize.cols),r=p(t,this.applyPromptOffset(this._input,this._cursor),this._termSize.cols),n=(r.col,e-r.row-1),i=0;i<n;++i)this.term.write("[E");for(this.term.write("\r[K"),i=1;i<e;++i)this.term.write("[F[K")}},{key:"setInput",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.clearInput();var r=this.applyPrompts(t);this.print(r),this._cursor>t.length&&(this._cursor=t.length);var n=this.applyPromptOffset(t,this._cursor),i=d(r,this._termSize.cols),s=p(r,n,this._termSize.cols),a=s.col,o=s.row,u=i-o-1;this.term.write("\r");for(var l=0;l<u;++l)this.term.write("[F");for(l=0;l<a;++l)this.term.write("[C");this._input=t}},{key:"printAndRestartPrompt",value:function(t){var e=this,r=this._cursor;this.setCursor(this._input.length),this.term.write("\r\n");var n=function(){e._cursor=r,e.setInput(e._input)},i=t();null==i?n():i.then(n)}},{key:"setCursor",value:function(t){t<0&&(t=0),t>this._input.length&&(t=this._input.length);var e=this.applyPrompts(this._input),r=(d(e,this._termSize.cols),p(e,this.applyPromptOffset(this._input,this._cursor),this._termSize.cols)),n=r.col,i=r.row,s=p(e,this.applyPromptOffset(this._input,t),this._termSize.cols),a=s.col,o=s.row;if(o>i)for(var u=i;u<o;++u)this.term.write("[B");else for(var l=o;l<i;++l)this.term.write("[A");if(a>n)for(var h=n;h<a;++h)this.term.write("[C");else for(var c=a;c<n;++c)this.term.write("[D");this._cursor=t}},{key:"handleCursorMove",value:function(t){if(t>0){var e=Math.min(t,this._input.length-this._cursor);this.setCursor(this._cursor+e)}else if(t<0){var r=Math.max(t,-this._cursor);this.setCursor(this._cursor+r)}}},{key:"handleCursorErase",value:function(t){var e=this._cursor,r=this._input;if(t){if(e<=0)return;var n=r.substr(0,e-1)+r.substr(e);this.clearInput(),this._cursor-=1,this.setInput(n,!1)}else{var i=r.substr(0,e)+r.substr(e+1);this.setInput(i)}}},{key:"handleCursorInsert",value:function(t){var e=this._cursor,r=this._input,n=r.substr(0,e)+t+r.substr(e);this._cursor+=t.length,this.setInput(n)}},{key:"handleReadComplete",value:function(){this.history&&this.history.push(this._input),this._activePrompt&&(this._activePrompt.resolve(this._input),this._activePrompt=null),this.term.write("\r\n"),this._active=!1}},{key:"handleTermResize",value:function(t){var e=t.rows,r=t.cols;this.clearInput(),this._termSize={cols:r,rows:e},this.setInput(this._input,!1)}},{key:"handleTermData",value:function(t){var e=this;if(this._active){if(null!=this._activeCharPrompt)return this._activeCharPrompt.resolve(t),this._activeCharPrompt=null,void this.term.write("\r\n");if(t.length>3&&27!==t.charCodeAt(0)){var r=t.replace(/[\r\n]+/g,"\r");Array.from(r).forEach((function(t){return e.handleData(t)}))}else this.handleData(t)}}},{key:"handleData",value:function(t){var e=this;if(this._active){var r,n,i,s,a=t.charCodeAt(0);if(27==a)switch(t.substr(1)){case"[A":if(this.history){var u=this.history.getPrevious();u&&(this.setInput(u),this.setCursor(u.length))}break;case"[B":if(this.history){var p=this.history.getNext();p||(p=""),this.setInput(p),this.setCursor(p.length)}break;case"[D":this.handleCursorMove(-1);break;case"[C":this.handleCursorMove(1);break;case"[3~":this.handleCursorErase(!1);break;case"[F":this.setCursor(this._input.length);break;case"[H":this.setCursor(0);break;case"b":null!=(r=c(this._input,this._cursor))&&this.setCursor(r);break;case"f":n=this._input,i=this._cursor,null!=(r=null==(s=h(n,!1).find((function(t){return t>i})))?n.length:s)&&this.setCursor(r);break;case"":null!=(r=c(this._input,this._cursor))&&(this.setInput(this._input.substr(0,r)+this._input.substr(this._cursor)),this.setCursor(r))}else if(a<32||127===a)switch(t){case"\r":!function(t){return""!=t.trim()&&((t.match(/'/g)||[]).length%2!=0||(t.match(/"/g)||[]).length%2!=0||""==t.split(/(\|\||\||&&)/g).pop().trim()||!(!t.endsWith("\\")||t.endsWith("\\\\")))}(this._input)?this.handleReadComplete():this.handleCursorInsert("\n");break;case"":this.handleCursorErase(!0);break;case"\t":if(this._autocompleteHandlers.length>0){var d=this._input.substr(0,this._cursor),m=(f(d),function(t,e){var r=l(e),n=r.length-1;return r[n],""===e.trim()?n=0:f(e)&&(n+=1),t.reduce((function(t,e){var i=e.fn,s=e.args;try{return t.concat(i.apply(void 0,[n,r].concat(o(s))))}catch(e){return console.error("Auto-complete error:",e),t}}),[])}(this._autocompleteHandlers,d));if(m.sort(),0===m.length);else if(1===m.length){var y=v(d);this.handleCursorInsert(m[0].substr(y.length))}else if(m.length<=this.maxAutocompleteEntries){var _=function t(e,r){if(e.length>=r[0].length)return e;var n=e;e+=r[0].slice(e.length,e.length+1);for(var i=0;i<r.length;i++){if(!r[i].startsWith(n))return null;if(!r[i].startsWith(e))return n}return t(e,r)}(d,m);if(_){var g=v(d);this.handleCursorInsert(_.substr(g.length))}this.printAndRestartPrompt((function(){e.printWide(m)}))}else this.printAndRestartPrompt((function(){return e.readChar("Display all ".concat(m.length," possibilities? (y or n)")).then((function(t){"y"!=t&&"Y"!=t||e.printWide(m)}))}))}else this.handleCursorInsert("    ");break;case"":this.setCursor(this._input.length),this.term.write("^C\r\n"+((this._activePrompt||{}).prompt||"")),this._input="",this._cursor=0,this.history&&this.history.rewind()}else this.handleCursorInsert(t)}}}])&&y(e.prototype,r),n&&y(e,n),t}();e.default=_}]).default;
//# sourceMappingURL=local-echo.js.map